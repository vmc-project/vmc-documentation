<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.55.6" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Stacking of Particles :: VMC</title>

    
    <link href="/css/nucleus.css?1564490325" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1564490325" rel="stylesheet">
    <link href="/css/hybrid.css?1564490325" rel="stylesheet">
    <link href="/css/featherlight.min.css?1564490325" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1564490325" rel="stylesheet">
    <link href="/css/auto-complete.css?1564490325" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1564490325" rel="stylesheet">
    <link href="/css/theme.css?1564490325" rel="stylesheet">
    <link href="/css/hugo-theme.css?1564490325" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1564490325" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1564490325"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/geant4_vmc/stacking-of-particles/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img src="/images/VMClogo6.png" width=80% />

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1564490325"></script>
<script type="text/javascript" src="/js/auto-complete.js?1564490325"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/example.org\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1564490325"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/download/" title="" class="dd-item 
        
        
        
        ">
      <a href="/download/">
          <b>1. </b>Download
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/installation/" title="Installation" class="dd-item 
        
        
        
        ">
      <a href="/installation/">
          <b>2. </b>Installation
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/installation/vmc/" title="Installing VMC" class="dd-item ">
        <a href="/installation/vmc/">
        VMC
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/installation/geant3/" title="Installing Geant3" class="dd-item 
        
        
        
        ">
      <a href="/installation/geant3/">
          Geant3
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
             
            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/installation/geant4_vmc/" title="Installing Geant4 VMC" class="dd-item 
        
        
        
        ">
      <a href="/installation/geant4_vmc/">
          Geant4 VMC
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
             
            
          
             
            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/installation/examples/" title="Installing and Running Examples" class="dd-item 
        
        
        
        ">
      <a href="/installation/examples/">
          Examples
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
             
            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/vmc/" title="VMC" class="dd-item 
        
        
        
        ">
      <a href="/vmc/">
          <b>3. </b>VMC
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/examples/" title="" class="dd-item 
        
        
        
        ">
      <a href="/examples/">
          <b>4. </b>Examples
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/geant4_vmc/" title="Geant4 VMC" class="dd-item 
        parent
        
        
        ">
      <a href="/geant4_vmc/">
          <b>5. </b>Geant4 VMC
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/geometry-definition-navigation/" title="Geometry Definition &amp; Navigation" class="dd-item ">
        <a href="/geant4_vmc/geometry-definition-navigation/">
        Geometry Definition &amp; Navigation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/magnetic-field/" title="Magnetic Field" class="dd-item ">
        <a href="/geant4_vmc/magnetic-field/">
        Magnetic Field
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/sensitive-volumes/" title="Sensitive Detectors and Volumes" class="dd-item ">
        <a href="/geant4_vmc/sensitive-volumes/">
        Sensitive Detectors and Volumes
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/physics-lists/" title="Physics Lists" class="dd-item ">
        <a href="/geant4_vmc/physics-lists/">
        Physics Lists
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/stacking-of-particles/" title="Stacking of Particles" class="dd-item active">
        <a href="/geant4_vmc/stacking-of-particles/">
        Stacking of Particles
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/special-cuts-and-regions/" title="Special Cuts and Regions" class="dd-item ">
        <a href="/geant4_vmc/special-cuts-and-regions/">
        Special Cuts and Regions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/user-geant4-classes/" title="User Geant4 Classes" class="dd-item ">
        <a href="/geant4_vmc/user-geant4-classes/">
        User Geant4 Classes
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/visualization/" title="Visualization" class="dd-item ">
        <a href="/geant4_vmc/visualization/">
        Visualization
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/switching-user-interfaces/" title="Switching User Interfaces" class="dd-item ">
        <a href="/geant4_vmc/switching-user-interfaces/">
        Switching User Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/multi-threaded-processing/" title="Multi-threaded Processing" class="dd-item ">
        <a href="/geant4_vmc/multi-threaded-processing/">
        Multi-threaded Processing
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/verbosity/" title="Vebosity" class="dd-item ">
        <a href="/geant4_vmc/verbosity/">
        Vebosity
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/vebosity-for-developers/" title="Vebosity for Developers" class="dd-item ">
        <a href="/geant4_vmc/vebosity-for-developers/">
        Vebosity for Developers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/geant4_vmc/source-code-documentation/" title="Source code documentation" class="dd-item ">
        <a href="/geant4_vmc/source-code-documentation/">
        Source code documentation
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/geant3&#43;vmc/" title="Geant3 &#43; VMC" class="dd-item 
        
        
        
        ">
      <a href="/geant3&#43;vmc/">
          <b>6. </b>Geant3 &#43; VMC
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/g4root/" title="G4Root" class="dd-item 
        
        
        
        ">
      <a href="/g4root/">
          <b>7. </b>G4Root
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/mtroot/" title="MTRoot" class="dd-item 
        
        
        
        ">
      <a href="/mtroot/">
          <b>8. </b>MTRoot
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/publications/" title="Publications" class="dd-item 
        
        
        
        ">
      <a href="/publications/">
          <b>9. </b>Publications
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
             
            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/support/" title="Support" class="dd-item 
        
        
        
        ">
      <a href="/support/">
          <b>10. </b>Support
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/support/mailing-list/" title="Mailing List" class="dd-item ">
        <a href="/support/mailing-list/">
        Mailing List
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/support/bug-reports/" title="Bug Reports" class="dd-item ">
        <a href="/support/bug-reports/">
        Bug Reports
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>VMC Documentation</a> > <a href='/geant4_vmc/'>Geant4 VMC</a> > Stacking of Particles
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Stacking of Particles
            </h1>
          

        



<p>The user  <a href="../../../../../../../root/htmldoc/TVirtualMCStack.html"> VMC stack </a> is used differently in Geant3 VMC and Geant4 VMC. Geant3 VMC pops both primary and secondary particles as they are provided by TVirtualMCStack::PopNextTrack(), while Geant4 VMC pops only primary particles using TVirtualMCStack::PopPrimaryForTracking() from the VMC stack. 

<p>
Stacking of secondary particles is then handled by Geant4 kernel and the user VMC stack only monitors this stacking. By default, Geant4 VMC saves each secondary particle when it starts its tracking (at the the pre-track phase). User can customize this default behaviour and choose also not to save secondary particles at all or to save them in the step of their parent particle, immediately after their creation.
This can be done using the command (see in the section on <a href="/drupal/content/user-interfaces"> User Interfaces</a> how to apply Geant4 commands in a Root user session):
<bash>/mcTracking/saveSecondaries selection
   selection = DoNotSave, SaveInPreTrack, SaveInStep
</bash>

<p>The consequence of this is that, by default, the particles added to the VMC stack in other than TVirtualMCApplication::GeneratePrimaries() functions are ignored in Geant4 tracking. User has to activate the stack popper special process (see <a href="http://root.cern.ch/drupal/content/physics-list-selection"> section on Physics list selection</a>), if he wants to add particles to the stack during tracking. The added particles are then handled as secondaries of the current track.</p>

<p>The stack classes in the VMC examples provide the same stacking mechanism for both Geant3 and Geant4 MCs and they are recommended to be used in a user application. <a name="Impl_SpecialCuts"></a></p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/geant4_vmc/physics-lists/" title="Physics Lists"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/geant4_vmc/special-cuts-and-regions/" title="Special Cuts and Regions" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1564490325"></script>
    <script src="/js/perfect-scrollbar.min.js?1564490325"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1564490325"></script>
    <script src="/js/jquery.sticky.js?1564490325"></script>
    <script src="/js/featherlight.min.js?1564490325"></script>
    <script src="/js/html5shiv-printshiv.min.js?1564490325"></script>
    <script src="/js/highlight.pack.js?1564490325"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1564490325"></script>
    <script src="/js/learn.js?1564490325"></script>
    <script src="/js/hugo-learn.js?1564490325"></script>

    <link href="/mermaid/mermaid.css?1564490325" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1564490325"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

